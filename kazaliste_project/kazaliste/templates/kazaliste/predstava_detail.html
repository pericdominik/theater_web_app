{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">

<h2>{{ predstava.title }}</h2>

{% if predstava.image %}
  <img src="{{ predstava.image.url }}" alt="{{ predstava.title }}" style="max-width:240px;">
{% endif %}

<p><strong>Trajanje:</strong> {{ predstava.duration_minutes }} min</p>
<p><strong>Preporučena dob:</strong> {{ predstava.age_min }}+</p>

{% if predstava.description %}
  <p>{{ predstava.description|linebreaks }}</p>
{% endif %}

<p>❤ {{ like_count }}
{% if request.user.is_authenticated %}
  {% if user_liked %}
    <a href="{% url 'predstava_like_remove' predstava.pk %}">Makni lajk</a>
  {% else %}
    <a href="{% url 'predstava_like_add' predstava.pk %}">Lajkaj</a>
  {% endif %}
{% else %}
  <small><a href="{% url 'login' %}">Prijavi se</a> za lajkanje</small>
{% endif %}
</p>

{% if upcoming %}
  <h3>Nadolazeći termini</h3>
  <ul>
    {% for e in upcoming %}
      <li>{{ e.date|date:"d.m.Y" }} u {{ e.time|time:"H:i" }} — {{ e.dvorana }}</li>
    {% endfor %}
  </ul>
{% endif %}

<h3>Komentari</h3>
{% if comments %}
  <ul>
    {% for c in comments %}
      <li><strong>{{ c.user.username }}</strong> — {{ c.created_at|date:"d.m.Y H:i" }}<br>{{ c.text|linebreaks }}</li>
    {% endfor %}
  </ul>
{% else %}
  <p><em>Nema komentara.</em></p>
{% endif %}

{% if request.user.is_authenticated %}
  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Pošalji komentar</button>
  </form>
{% else %}
  <p><small><a href="{% url 'login' %}">Prijavi se</a> da bi ostavio komentar.</small></p>
{% endif %}

<p><a href="{% url 'predstave_list' %}">← Natrag na sve predstave</a></p>
